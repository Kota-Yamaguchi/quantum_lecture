
アダマールテストでは、ベクトル

アダマールテストの構成を説明する。以下のような図で構成されている。
第一ビットに $\ket{0}$ 、第二ビット以降には$\ket{\psi}$ とする。
第一ビットにアダマールゲートを作用させる。その後に制御ユニタリゲートをその他のビット列から第一ビットに向けて作用させる。
そして、第一ビットにアダマールゲートを作用させてから測定する。

図１



では実際の回路でどのような演算が行われているかを確認していこうと思う。
①の段階では以下のようになっている。
$$ \ket{0} \otimes \ket{\psi} $$

まずはここでの数式での意味合いを少し考えよう。
なぜ並ぶ量子ビットのテンソル積で表すことができるのだろうか。それは一言で言うと、この量子ビットは複合系だからである。
複合系とは、色々な系が組み合わさってできている系のことを言う。例えば、空気は酸素と窒素と二酸化炭素とそのほかの気体との複合系である。もっと言うと酸素は空気の部分系という。
複合系では、色々な組み合わせが発生する。ここで考えることとして、コインを例に考えてみる。
コイン１だけの系だと、表、裏という組み合わせしか存在しない。
だが、コイン１とコイン２の複合系だとそれだけで
$$(コイン1, 2) = (表, 裏), (表, 表) , (裏, 表) ,(裏, 裏) $$
と組み合わせが大きく増える。
テンソル積はこれをうまく一つのベクトルにうまく変換することができる方法の一つである。
コインを例に取ると以下のようなことを表現できる。
$$(コイン1, 2) = \left[
    \begin{array}{c}
    (表, 裏)になる確率\\ (表, 表)になる確率 \\ (裏, 表)になる確率 \\(裏, 裏)になる確率 
    \end{array}
 \right]$$

テンソル積の具体的な計算方法は以下のようにできる。これはテンソル積の中でもクロネッカー積と言われている。
$$ \ket{a} = \left[
    \begin{array}{c} 
 a_0\\
 a_1\\
 \end{array}
 \right]$$

$$\ket{b} = \left[
    \begin{array}{c} 
 b_0\\
 b_1\\
 \end{array}
 \right]
 $$

$$\ket{a} \otimes \ket{b} = \left[
    \begin{array}{c} 
 a_0 \times \left[
    \begin{array}{c} 
 b_0\\
 b_1\\
 \end{array}
 \right] \\
 a_1\times \left[
    \begin{array}{c} 
 b_0\\
 b_1\\
 \end{array}
 \right]\\
 \end{array}
 \right] 
 = \left[
    \begin{array}{c} 
 a_0b_0\\
 a_0b_1\\
 a_1b_0\\
 a_1b_1\\
 \end{array}
 \right]$$
テンソル積の定義に関しては参考情報を参照してほしい。
なので、量子回路に関しては、ビット列1とその他のビット列の複合系になっているので、テンソル積となっている。



次に②の段階ではアダマールゲートが作用しているので、以下のようになる。アダマールゲートが$\ket{0}$に作用した結果である。

$$ \frac{\ket{1}+\ket{0}}{\sqrt{2}} \ket{\psi}  $$

そして③では制御ユニタリゲートが作用する。制御ユニタリゲートでは、$\ket{0}$の時は、作用はせずに$\ket{1}$の時には作用するif文のような動作となる。つまり$\ket{0}$には$\ket{\psi}$を、 $\ket{1}$には$U\ket{\psi}$を作用させることになる。数式としては以下のように表される。

$$ \frac{1}{\sqrt{2}} ( \ket{1}U\ket{\psi} + \ket{0}\ket{\psi})  $$

そして最後もう一度アダマールゲートを第１ビットに作用させる。
これで、すると


$$ \frac{1}{\sqrt{2}} ( \frac{\ket{0}-\ket{1}}{\sqrt{2}}U\ket{\psi}　+\frac{\ket{1}+\ket{0}}{\sqrt{2}}\ket{\psi})  \tag{1}$$

$$ \frac{1}{2} ( (\ket{0}-\ket{1})U\ket{\psi}　+(\ket{0}+\ket{1})\ket{\psi})  \tag{2}$$

$$ \frac{1}{2} ( \ket{0}(U+I)\ket{\psi}　+\ket{1}(-U+I)\ket{\psi}  \tag{3}$$


そして最後に第一ビットを測定する。

では第一ビットで$\ket{0}$が観測される確率はどのくらいになるのだろうか。

それは式(3)で$\ket{0}$のノルム分だけとなる。つまり内積をとり、

$$ p_0=\frac{1}{4} \bra{\psi}(U^\dagger+I) (U+I)\ket{\psi} $$

すなわち以下のようになる。(ここ詳細に書く)

$$ p_0=\frac{1+ Re\bra{\psi}U\ket{\psi}}{2}  $$

つまりは何がわかるかというと、何回も何回も測定を繰り返し$\ket{0}$をサンプリングすることで $Re\bra{\psi}U\ket{\psi}$を推定することができるのである。では$ Im\bra{\psi}U\ket{\psi} $に関しては補量子ビットに位相演算子Sを付け加えたもので計算が可能である。
では$ Im\bra{\psi}U\ket{\psi} $と$Re\bra{\psi}U\ket{\psi}$つまり$\bra{\psi}U\ket{\psi}$の意味を考えると、これはUに対しての対角化の形になっている。つまりは$\ket{\psi}$がUの固有状態と考えると、$\bra{\psi}U\ket{\psi}$がわかるということは、$\ket{\psi}$の固有値を推定することとなる。
つまりアダマールテストを繰り返すことで、入力となる固有状態$\ket{\psi}$の固有値を推定できる。
ここで思う事として、古典コンピュータでも固有値を計算することぐらい可能ではないか、と思われるかもしれない。
固有値を計算するにあたって

ただアダマールテストで固有値を推定するのにも、いくつかのデメリットが存在する。
1. 測定を繰り返し実施する必要があること
固有値の推定値をある一定の誤差以下に収めるのに必要な回数がある。それは以下のにHoeffding不等式を用いてとある誤差$\epsilon$以下に抑えるために必要なサンプル回数を求める事ができる。ここではそれに関しての記述はしない。以下を参考となる。http://mercury.yukawa.kyoto-u.ac.jp/~bussei.kenkyu/wp/wp-content/uploads/6200-064217.pdf

